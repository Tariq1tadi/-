<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>طلب خدمات التنظيف</title>
<style>
  body { font-family: Arial, sans-serif; direction: rtl; margin: 20px; background: #f9f9f9; }
  .service { background: #fff; padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  label { display: block; margin: 8px 0 4px; }
  input[type=text], input[type=number], select { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
  button { padding: 10px 15px; border: none; border-radius: 5px; background: #007bff; color: white; cursor: pointer; margin-top: 10px; }
  button:hover { background: #0056b3; }
  .price-line { margin-top: 10px; font-weight: bold; color: #333; }
  #totalPrice { font-weight: bold; margin-top: 20px; font-size: 1.2em; }
</style>
</head>
<body>

<h2>اختر خدمات التنظيف</h2>

<div id="servicesContainer"></div>

<button id="addServiceBtn">أضف خدمة</button>

<div id="totalPrice">السعر الإجمالي: 0 ريال</div>

<script>
const serviceTypes = [
  { name: 'سجاد', unitPrice: 6 },
  { name: 'بطانية', unitPrice: 8 },
  { name: 'لحاف', unitPrice: 8 }
];

const servicesContainer = document.getElementById('servicesContainer');
const addServiceBtn = document.getElementById('addServiceBtn');
const totalPriceElem = document.getElementById('totalPrice');

let servicesCount = 0;

function createServiceBlock(id) {
  const div = document.createElement('div');
  div.className = 'service';
  div.dataset.id = id;

  const serviceLabel = document.createElement('label');
  serviceLabel.textContent = 'اختر الخدمة:';
  const serviceSelect = document.createElement('select');
  serviceSelect.name = `serviceType_${id}`;

  serviceTypes.forEach(s => {
    const option = document.createElement('option');
    option.value = s.name;
    option.textContent = s.name;
    serviceSelect.appendChild(option);
  });

  const dynamicFields = document.createElement('div');
  const priceDisplay = document.createElement('div');
  priceDisplay.className = 'price-line';
  priceDisplay.id = `price_${id}`;
  priceDisplay.textContent = 'السعر: 0 ريال';

  serviceSelect.addEventListener('change', () => {
    updateDynamicFields(serviceSelect.value, dynamicFields, priceDisplay, id);
    calculateTotal();
  });

  div.appendChild(serviceLabel);
  div.appendChild(serviceSelect);
  div.appendChild(dynamicFields);
  div.appendChild(priceDisplay);

  servicesContainer.appendChild(div);

  updateDynamicFields(serviceSelect.value, dynamicFields, priceDisplay, id);
}

function updateDynamicFields(serviceType, container, priceDisplay, id) {
  container.innerHTML = '';

  if (serviceType === 'سجاد') {
    const lengthLabel = document.createElement('label');
    lengthLabel.textContent = 'الطول (بالمتر):';
    const lengthInput = document.createElement('input');
    lengthInput.type = 'number';
    lengthInput.min = '0';
    lengthInput.name = `length_${id}`;

    const widthLabel = document.createElement('label');
    widthLabel.textContent = 'العرض (بالمتر):';
    const widthInput = document.createElement('input');
    widthInput.type = 'number';
    widthInput.min = '0';
    widthInput.name = `width_${id}`;

    container.appendChild(lengthLabel);
    container.appendChild(lengthInput);
    container.appendChild(widthLabel);
    container.appendChild(widthInput);

    lengthInput.addEventListener('input', () => {
      calculateTotal();
    });
    widthInput.addEventListener('input', () => {
      calculateTotal();
    });

  } else if (serviceType === 'بطانية' || serviceType === 'لحاف') {
    const countLabel = document.createElement('label');
    countLabel.textContent = 'العدد:';
    const countInput = document.createElement('input');
    countInput.type = 'number';
    countInput.min = '0';
    countInput.name = `count_${id}`;

    container.appendChild(countLabel);
    container.appendChild(countInput);

    countInput.addEventListener('input', () => {
      calculateTotal();
    });
  }
}

function calculateTotal() {
  let total = 0;

  document.querySelectorAll('.service').forEach(div => {
    const id = div.dataset.id;
    const serviceType = div.querySelector(`select[name=serviceType_${id}]`).value;
    const priceElem = document.getElementById(`price_${id}`);
    let localPrice = 0;

    if (serviceType === 'سجاد') {
      const length = parseFloat(div.querySelector(`[name=length_${id}]`)?.value || 0);
      const width = parseFloat(div.querySelector(`[name=width_${id}]`)?.value || 0);
      const area = length * width;
      localPrice = area * 6;
    } else if (serviceType === 'بطانية' || serviceType === 'لحاف') {
      const count = parseInt(div.querySelector(`[name=count_${id}]`)?.value || 0);
      localPrice = count * 8;
    }

    priceElem.textContent = `السعر: ${localPrice.toFixed(2)} ريال`;
    total += localPrice;
  });

  totalPriceElem.textContent = `السعر الإجمالي: ${total.toFixed(2)} ريال`;
}

addServiceBtn.addEventListener('click', () => {
  createServiceBlock(++servicesCount);
});

createServiceBlock(++servicesCount);
</script>

</body><div style="background: #004aad; color: white; padding: 20px; text-align: center;">
  <img src="logo.png" alt="شعار الموقع" style="height: 80px;"><br>
  <h1>مرحبا بكم في موقع التنظيف</h1>
</div>

</html>
